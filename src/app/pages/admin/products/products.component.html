<div class="p-8 bg-gray-100 min-h-screen">

  <!-- Header -->
  <div class="flex justify-between mb-4 items-center">
    <h1 class="text-2xl font-bold">Manage Products</h1>
    <button
      (click)="openAddModal()"
      class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
      + Add Product
    </button>
  </div>

  <!-- ðŸ” Search -->
  <div class="mb-4">
<input
  type="text"
  [(ngModel)]="searchText"
  (keyup.enter)="onSearch()"
  placeholder="Search by name, category or price..."
  class="w-full md:w-1/3 px-3 py-2 border rounded" />

  </div>

  <!-- Products Table -->
  <div class="overflow-x-auto">
    <table class="w-full bg-white shadow rounded border-collapse">
      <thead class="bg-gray-50">
        <tr>
          <th class="p-3 text-left border-b cursor-pointer" (click)="changeSort('id')">
            ID {{ sortBy === 'id' ? (sortOrder === 'asc' ? 'â†‘' : 'â†“') : '' }}
          </th>

          <th class="p-3 text-center border-b">Images</th>

          <th class="p-3 text-left border-b cursor-pointer" (click)="changeSort('name')">
            Name {{ sortBy === 'name' ? (sortOrder === 'asc' ? 'â†‘' : 'â†“') : '' }}
          </th>

          <th class="p-3 text-left border-b cursor-pointer" (click)="changeSort('price')">
            Price {{ sortBy === 'price' ? (sortOrder === 'asc' ? 'â†‘' : 'â†“') : '' }}
          </th>

          <th class="p-3 text-left border-b cursor-pointer" (click)="changeSort('category')">
            Category {{ sortBy === 'category' ? (sortOrder === 'asc' ? 'â†‘' : 'â†“') : '' }}
          </th>

          <th class="p-3 text-left border-b">Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let p of products" class="hover:bg-gray-50">
          <td class="p-3 border-b">{{ p.id }}</td>

          <!-- Images -->
          <td class="p-3 border-b">
            <div class="flex justify-center gap-2">
              <img
                *ngFor="let img of p.ProductImages || []"
                [src]="getImageUrl(img.url)"
                class="w-10 h-10 rounded object-cover border" />
            </div>
          </td>

          <td class="p-3 border-b whitespace-nowrap">{{ p.name }}</td>
          <td class="p-3 border-b whitespace-nowrap">â‚¹{{ p.price }}</td>
          <td class="p-3 border-b whitespace-nowrap">{{ p.Category?.name }}</td>

          <!-- Actions -->
          <td class="p-3 border-b">
            <div class="flex gap-3 whitespace-nowrap">
              <button (click)="editProduct(p)" class="text-blue-600 hover:underline">Edit</button>
              <button (click)="deleteProduct(p.id)" class="text-red-600 hover:underline">Delete</button>
            </div>
          </td>
        </tr>

        <!-- No data -->
        <tr *ngIf="products.length === 0">
          <td colspan="6" class="p-4 text-center text-gray-500">
            No products found
          </td>
        </tr>
      </tbody>
    </table>

    
<div class="flex justify-end items-center gap-3 mt-4">
  <button
    (click)="changePage(currentPage - 1)"
    [disabled]="currentPage === 1"
    class="px-3 py-1 border rounded">
    Prev
  </button>

  <span>Page {{ currentPage }} of {{ totalPages }}</span>

  <button
    (click)="changePage(currentPage + 1)"
    [disabled]="currentPage === totalPages"
    class="px-3 py-1 border rounded">
    Next
  </button>
</div>
  </div>

</div>



<!-- Product Modal -->
<app-product-modal
  *ngIf="showModal"
  [product]="editingProduct"
  [categories]="categories"
  (close)="closeModal()"
  (saved)="saveProduct($event)">
</app-product-modal>
